<div class="min-h-screen bg-gray-50 py-8">
  <div class="container mx-auto px-4">
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">Our Products</h1>
      <p class="text-gray-600">Discover our exquisite collection of perfumes</p>
    </div>

    <div class="flex flex-col lg:flex-row gap-8">
      <!-- Sidebar Filters -->
      <aside class="lg:w-64 flex-shrink-0">
        <div class="bg-white rounded-lg shadow-md p-6 sticky top-24">
          <h2 class="text-lg font-semibold text-gray-800 mb-4">Filters</h2>
          
          <!-- Search -->
          <div class="mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">Search</label>
            <input type="text" 
                   [(ngModel)]="searchTerm"
                   (input)="onSearch()"
                   placeholder="Search products..."
                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
          </div>

          <!-- Categories -->
          <div class="mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
            <select [(ngModel)]="selectedCategory" 
                    (change)="onCategoryChange(selectedCategory)"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
              <option [value]="null">All Categories</option>
              <option *ngFor="let category of categories" [value]="category.category_id">
                {{ category.category_name }}
              </option>
            </select>
          </div>

          <!-- Brands -->
          <div class="mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">Brand</label>
            <select [(ngModel)]="selectedBrand" 
                    (change)="onBrandChange(selectedBrand)"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
              <option [value]="null">All Brands</option>
              <option *ngFor="let brand of brands" [value]="brand.brand_id">
                {{ brand.brand_name }}
              </option>
            </select>
          </div>

          <!-- Sort -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Sort By</label>
            <select [(ngModel)]="sortBy" 
                    (change)="onSortChange()"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
              <option value="name">Name (A-Z)</option>
              <option value="price-low">Price: Low to High</option>
              <option value="price-high">Price: High to Low</option>
            </select>
          </div>
        </div>
      </aside>

      <!-- Products Grid -->
      <div class="flex-1">
        <div *ngIf="loading" class="text-center py-12">
          <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"></div>
        </div>

        <div *ngIf="!loading && paginatedProducts.length > 0" 
             class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
          <div *ngFor="let product of paginatedProducts" 
               class="bg-white rounded-lg shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden group">
            <div class="relative overflow-hidden">
              <img [src]="getProductImage(product.image_url)" 
                   [alt]="product.perfume_name"
                   class="w-full h-64 object-cover group-hover:scale-110 transition-transform duration-300">
              <div class="absolute top-2 right-2">
                <span *ngIf="product.stock > 0" class="bg-green-500 text-white px-2 py-1 rounded text-xs">In Stock</span>
                <span *ngIf="product.stock === 0" class="bg-red-500 text-white px-2 py-1 rounded text-xs">Out of Stock</span>
              </div>
            </div>
            <div class="p-4">
              <h3 class="font-semibold text-gray-800 mb-2 line-clamp-1">{{ product.perfume_name }}</h3>
              <p class="text-sm text-gray-600 mb-2" *ngIf="product.brand?.brand_name">
                {{ product.brand?.brand_name }}
              </p>
              <p class="text-sm text-gray-500 mb-3 line-clamp-2" *ngIf="product.description">
                {{ product.description }}
              </p>
              <div class="flex items-center justify-between">
                <span class="text-2xl font-bold text-purple-600">${{ product.price }}</span>
                <div class="flex gap-2">
                  <a [routerLink]="['/products/product', product.perfume_id]" 
                     class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors">
                    View
                  </a>
                  <button (click)="addToCart(product)" 
                          [disabled]="product.stock === 0"
                          class="px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                    Add
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="!loading && paginatedProducts.length === 0" class="text-center py-12">
          <p class="text-gray-600 text-lg">No products found matching your criteria.</p>
        </div>

        <!-- Pagination -->
        <div *ngIf="!loading && totalPages > 1" class="flex justify-center items-center gap-2 mt-8">
          <button (click)="changePage(currentPage - 1)" 
                  [disabled]="currentPage === 1"
                  class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
            Previous
          </button>
          <span class="px-4 py-2 text-gray-700">
            Page {{ currentPage }} of {{ totalPages }}
          </span>
          <button (click)="changePage(currentPage + 1)" 
                  [disabled]="currentPage === totalPages"
                  class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
            Next
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
